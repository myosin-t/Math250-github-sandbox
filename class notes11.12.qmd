---
title: "class notes11.12"
format: html
author: Mio Takata
embed-resources: true
---

```{r}
#| label: setup
#| message: false
library(tidyverse)
library(readxl)
trout = read_excel("trout.xlsx")
```

Do trout at the difference locations have different hemoglobin levels?

$H_0$: the *population* means of "Hemo" are the same for all locations.
$H_a$: the population means of "Hemo" are not the same for all locations.


```{r}
trout <- trout %>% 
  mutate(Location = as.factor(Location)) # making numbers into descrete variable

ggplot(trout, aes(x = Location, y = Hemo))+
  geom_boxplot()+
  geom_jitter()
```

Let's run the test.

```{r}
model<- aov(Hemo ~ Location, data = trout)
summary(model)
```

is himo explained at all from location
low p value is against the null hypothesis of hemo is not explained by the location
possible? sure but plausible, maybe not

The tiny p value indicates good evience against the null, we can conclude that `Location` does give information about `Hemo`. Trout at difference locations do seems to have difference `Hemo `level  

This does *not* say anything about which groups might be different. To do that, we need to do some pairwise comparisons.However, if we just run all pf those directlym there is a high probability of getting at least one small p-value just by chance, even if there really isn't a difference

## The Tukey post-hoc test 
To correctly follow up a positive ANOVA, use a *Tukey Honest Standard Differences Test* which does a pairwise comparison for each pair of groups, correcting for the multiple tests/
```{r}
TukeyHSD(model)
```
# conclusion from the Tukey test
There is good evidece that 1 and 2 are different. The evidence that 1 and 3 are different is weaker, and the evidence that 1 and 4 are different is certainly insufficient.

*95%*family-wise confidence level means that there is a 5% of false positive.

## Example: penguins
$H_0$: bill length is the same for all three species.
$H_1$: bill length is not the same.

```{r}
ggplot(penguins, aes(x = bill_len, y = species))+
  geom_boxplot()
```

```{r}
model_2<- aov(bill_len ~ species, data = penguins)
summary(model_2)
```
does species give information about bill_len or species.
There is a very strong evidence($p<4\times10^{-16}$) that `bill_len` is not independent from `species`.

```{r}
TukeyHSD(model_2)
```

